# 时间胶囊
## 项目功能
项目基于React进行开发，功能类似时间胶囊网站 (https://p.timepill.net/) ,用户可以在网页中发布时间胶囊并设置打开时间，当且仅当设置的时间抵达后，用户才可以打开胶囊并查看其中的内容。

## 项目启动
1. 在终端中进入项目文件夹wps_template。
2. 使用npm i 按照对应依赖包。
3. 再使用npm run build即可在build文件夹构建出网页文件。
4. 再使用npm i -g serve和serve -s build两条命令即可启动项目。
5. 或者用户也可以通过npm start的形式直接启动开发版项目

## 开发思路
+ 根据项目的功能，项目被分为Main(首页)、Action(后续页面的共有导航栏)、Open(打开胶囊)、Put(创建胶囊)、Success(成功创建胶囊)等页面。
+ 项目使用React-Router中的HashRouter进行开发，其中一级路由界面有Main与Action，剩余的Open、Put、Success界面都为Action的子路由。

## 页面详解
### Main
在本项目中我们采用useNavigate进行路由跳转，通过点击事件的设置，使用户在点击对应文字时，能够成功跳转到对应的也页面（Action/open与Action/put）。
### Action
1. 在本界面下含有Put、Open、Success三个子页面，因此在本页面中，我们要展示页面顶上的导航栏，同时使用 Outlet 组件为子页面设置对应的展示空间。  
2. 为了能够正确实现导航栏的功能，在Action界面中我们需要得到当前界面的具体路由(路径)。为了实现这一目的，我们使用了 useLocation 的hook来获得当前界面的相关信息。通过访问location对象的pathname，我们获取到对应界面的url，最后通过字符串识别将当前子界面对应的导航栏框颜色加深。
### Put
在本界面中，用户可以填写胶囊的具体信息并且创建胶囊，因此本用户应该实现一个能够正确获取数据并对特殊情况做出提示的表单。
+ 表单值的获取:  
在页面中，我们使用 useState 的hook来设置用来存储胶囊信息的对象。为了使表单信息能够与用户的输入同步，我们设置输入框的onchange事件，在输入框内容改变时，使用对应的set方法修改对象的值，从而实现数据同步获取数据。
+ 表单提交  
当用户按下提交按键时，我们进行错误信息检测，若检测通过，我们则将用户所创建的胶囊存入LocalStorage中，并为用户返回其key值(使用uuid-v4进行创建)。
+ 错误信息提示  
当用户按下提交键时，我们进行错误信息检测。若所获取到对象的对应属性项为空字符串，则说明对应输入框为空，展示未填信息提示。对于时间和邮箱两种特殊输入，我们对其字符串进行 **正则检测** ，若不符合设定的格式，则给用户展示格式错误信息提示。
+ 实现技巧  
  + 在使用对应set方法修改对象时，我们可以使用 **...** 运算符来克隆旧对象，从而达到修改特定属性项的效果。
  + 在进行错误信息显示的时候，我们可以采用以下三种形式(在项目中，我们使用第一种)
    + {mistake?错误信息组件:null}
    + {mistake&&错误信息组件}
    + 当mistake不存在时，将错误信息设置display:none样式，否则，则将其展示出来。
  + 对于时间的相关信息，在表单提交时，我们借助dayjs将对应格式的时间字符串转为时间戳存入内存中，以便未来取用和计算。
### Open
在Open界面中，获取用户想打开胶囊的key值，在其按下时间按钮后，我们计算时间，并根据时间是否已达来展示不同的信息。
+ 根据用户的key值，我们从LocalStorage中取出对应胶囊，通过dayjs获取当前时间的时间戳。若当前时间戳大于胶囊的时间戳，则向用户说明打开时间未至。否则，说明时间已至，未用户开启胶囊展示其中内容。
+ 当前时间戳大于胶囊的时间戳时，我们需要向用户展示胶囊开启时间距今的时间差，因此我们使用使用 useEffect 的hook，在页面因为pill值而刷新时，通过setInterval启动定时器，每隔一段时间重新计算当前时间差，刷新页面信息。
